<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Roblox Server Manager</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      background-color: #121212;
      color: #eee;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 20px;
    }

    h1 {
      color: #00bcd4;
      margin-bottom: 20px;
      font-size: 2rem;
    }

    .container {
      width: 100%;
      max-width: 460px;
      background-color: #1e1e1e;
      border-radius: 16px;
      padding: 20px;
      box-shadow: 0 8px 24px rgba(0,0,0,0.4);
    }

    input[type="text"],
    input[type="password"] {
      width: 100%;
      padding: 12px;
      margin-top: 8px;
      margin-bottom: 16px;
      border: none;
      border-radius: 10px;
      background-color: #2c2c2c;
      color: #fff;
      font-size: 1rem;
    }

    input:focus {
      outline: 2px solid #00bcd4;
    }

    button {
      width: 100%;
      padding: 14px;
      font-size: 1rem;
      font-weight: bold;
      border: none;
      border-radius: 12px;
      background-color: #00bcd4;
      color: #000;
      cursor: pointer;
      margin-top: 10px;
      box-shadow: 0 4px 12px rgba(0,188,212,0.3);
      transition: background 0.2s ease;
    }

    button:hover {
      background-color: #00a1b2;
    }

    .hidden {
      display: none;
    }

    .server-list {
      margin-top: 16px;
      max-height: 250px;
      overflow-y: auto;
      background: #2a2a2a;
      padding: 10px;
      border-radius: 12px;
    }

    .server-item {
      background-color: #1f1f1f;
      padding: 10px;
      border-radius: 10px;
      margin-bottom: 10px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .server-item a {
      color: #4dd0e1;
      text-decoration: none;
      font-weight: 500;
    }

    .server-item button {
      width: auto;
      margin-left: 8px;
      padding: 6px 10px;
      font-size: 0.9rem;
      background: #333;
      color: #ddd;
      box-shadow: none;
    }

    .server-item button:hover {
      background: #444;
    }

    .logout {
      background-color: #c62828;
      color: #fff;
      margin-top: 20px;
    }

    .logout:hover {
      background-color: #b71c1c;
    }
  </style>
</head>
<body>

  <h1>Private Server Manager</h1>

  <div class="container" id="loginContainer">
    <label>Username</label>
    <input type="text" id="usernameInput" placeholder="Enter your username" />
    <label>4-Digit PIN</label>
    <input type="password" id="pinInput" maxlength="4" placeholder="Enter 4-digit PIN" />
    <button id="loginBtn">Login / Create</button>
  </div>

  <div class="container hidden" id="managerContainer">
    <div id="welcomeMsg"></div>
    <input type="text" id="serverLinkInput" placeholder="Private server link" />
    <input type="text" id="serverNameInput" placeholder="Optional server name" />
    <button id="addServerBtn">Add Server</button>

    <div class="server-list" id="serverList"></div>

    <button class="logout" id="logoutBtn">Logout</button>
  </div>

  <script>
    const loginContainer = document.getElementById('loginContainer');
    const managerContainer = document.getElementById('managerContainer');
    const usernameInput = document.getElementById('usernameInput');
    const pinInput = document.getElementById('pinInput');
    const loginBtn = document.getElementById('loginBtn');
    const serverLinkInput = document.getElementById('serverLinkInput');
    const serverNameInput = document.getElementById('serverNameInput');
    const addServerBtn = document.getElementById('addServerBtn');
    const serverList = document.getElementById('serverList');
    const logoutBtn = document.getElementById('logoutBtn');
    const welcomeMsg = document.getElementById('welcomeMsg');

    let currentUser = null;
    let data = JSON.parse(localStorage.getItem('psm') || '{}');
    let pinAttempts = 0;
    let locked = false;

    function save() {
      localStorage.setItem('psm', JSON.stringify(data));
    }

    function login() {
      if (locked) return alert("Locked: Wait 1 minute");

      const user = usernameInput.value.trim();
      const pin = pinInput.value.trim();

      if (user.length === 0 || pin.length !== 4) {
        alert("Enter username and 4-digit PIN");
        return;
      }

      if (!data[user]) {
        data[user] = { pin, servers: [] };
        save();
      }

      if (data[user].pin !== pin) {
        pinAttempts++;
        if (pinAttempts >= 3) {
          locked = true;
          loginBtn.disabled = true;
          setTimeout(() => {
            locked = false;
            pinAttempts = 0;
            loginBtn.disabled = false;
          }, 60000);
        }
        return alert("Incorrect PIN");
      }

      currentUser = user;
      pinAttempts = 0;
      showManager();
    }

    function showManager() {
      loginContainer.classList.add('hidden');
      managerContainer.classList.remove('hidden');
      welcomeMsg.innerHTML = `<strong>Welcome, ${currentUser}</strong>`;
      renderServers();
    }

    function renderServers() {
      const servers = data[currentUser].servers || [];
      serverList.innerHTML = '';

      servers.forEach((srv, idx) => {
        const div = document.createElement('div');
        div.className = 'server-item';

        const link = document.createElement('a');
        link.href = srv.link;
        link.target = '_blank';
        link.textContent = `Join Server ${srv.name}`;

        const editBtn = document.createElement('button');
        editBtn.textContent = "✏️";
        editBtn.onclick = () => editServer(idx);

        const delBtn = document.createElement('button');
        delBtn.textContent = "🗑️";
        delBtn.onclick = () => deleteServer(idx);

        div.appendChild(link);
        div.appendChild(editBtn);
        div.appendChild(delBtn);
        serverList.appendChild(div);
      });
    }

    function addServer() {
      const link = serverLinkInput.value.trim();
      let name = serverNameInput.value.trim();

      if (!link) return alert("Please enter a private server link");
      if (!name) {
        const code = link.match(/code=([\w\d]+)/);
        name = code ? code[1].slice(0, 12) : "Unnamed";
      }

      data[currentUser].servers.push({ link, name });
      save();
      renderServers();
      serverLinkInput.value = '';
      serverNameInput.value = '';
    }

    function editServer(index) {
      const pin = prompt("Enter your 4-digit PIN to edit:");
      if (pin !== data[currentUser].pin) return alert("Incorrect PIN");

      const current = data[currentUser].servers[index];
      const link = prompt("Edit link:", current.link);
      const name = prompt("Edit name:", current.name);

      if (link && name) {
        data[currentUser].servers[index] = { link, name };
        save();
        renderServers();
      }
    }

    function deleteServer(index) {
      const pin = prompt("Enter your 4-digit PIN to delete:");
      if (pin !== data[currentUser].pin) return alert("Incorrect PIN");

      data[currentUser].servers.splice(index, 1);
      save();
      renderServers();
    }

    function logout() {
      currentUser = null;
      usernameInput.value = '';
      pinInput.value = '';
      loginContainer.classList.remove('hidden');
      managerContainer.classList.add('hidden');
    }

    loginBtn.onclick = login;
    addServerBtn.onclick = addServer;
    logoutBtn.onclick = logout;
  </script>
</body>
</html>
